// Minimal Prisma schema for provisioning only Invoice and InvoiceAttachment
// Uses same datasource and generator setup as main schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["financial", "public"]
}

model Invoice {
  id                   String               @id @default(uuid()) @db.Uuid
  userId               String               @map("user_id") @db.Uuid
  invoiceAttachments   InvoiceAttachment[]

  @@map("invoices")
  @@schema("financial")
}

model InvoiceAttachment {
  id          String    @id @default(uuid()) @db.Uuid
  invoiceId   String    @map("invoice_id") @db.VarChar(255)
  fileName    String    @map("file_name") @db.VarChar(255)
  filePath    String    @map("file_path")
  fileSize    BigInt    @map("file_size")
  fileType    String    @map("file_type") @db.VarChar(100)
  description String?
  uploadedBy  String    @map("uploaded_by") @db.VarChar(255)
  uploadedAt  DateTime  @default(now()) @map("uploaded_at") @db.Timestamptz(6)
  isDeleted   Boolean   @default(false) @map("is_deleted")
  deletedAt   DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy   String?   @map("deleted_by") @db.VarChar(255)

  invoice Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([invoiceId], map: "idx_invoice_attachments_invoice_id")
  @@map("invoice_attachments")
  @@schema("financial")
}
